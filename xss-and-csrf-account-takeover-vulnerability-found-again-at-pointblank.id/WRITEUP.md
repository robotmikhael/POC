# Penemuan BUG Part 2 : *Reflected XSS* and *CSRF Account Takeover* Again at Official Website PB Zepetto Indonesia
### Author : Mikhro <br><a href="https://www.facebook.com/josh.s.mikhael" rel="nofollow"><img src="https://img.shields.io/badge/contact-facebook-blue.svg" alt="Twitter" data-canonical-src="https://img.shields.io/badge/facebook-josh.s.mikhael-blue.svg" style="max-width:100%;"></a> <br> **Date** : <kbd> Senin, 15 April 2019</kbd>

> Tags : [#bugbounty](https://www.google.com/search?q=bugbounty) [#xss](https://www.google.com/search?q=xss) [#csrf](https://www.google.com/search?q=csrf) [#exploit](https://www.google.com/search?q=exploit) [#bughunter](https://www.google.com/search?q=bughunter) [#reflected_xss](https://www.google.com/search?q=reflected%20xss)

## ðŸ”¥ Proff Of Concept ðŸ”¥
Setelah beberapa hari yang lalu saya menemukan dan melaporkan bug **[open redirect lead to xss](https://github.com/robotmikhael/POC/blob/master/open-redirect-lead-to-xss-injection-at-pointblank.id/WRITEUP.md)** pada website PB Zepetto dan mendapat hadiah *2M* ðŸ˜Œ . Kali ini saya kembali iseng mencari bug pada website tersebut . <br> â€¢ Saya membuka setiap halaman pada website lalu menemukan halaman *[faq](https://www.pointblank.id/faq/list)* : <br>
![ss_halaman_faq](https://robotmikhael.github.io/img/IMG_20190415_102635.jpg) <br><br>
Dapat dilihat disitu ada *form pencarian* . Saya berpikir biasanya di form seperti ini rawan akan *celah/penyerangan* berjenis **[code injection](https://www.google.com/search?q=code%20injection)** semisal [XSS](https://www.google.com/search?q=xss), [SQLI](https://www.google.com/search?q=sqli) bahkan [RCE](https://www.google.com/search?q=rce). <br> â€¢ Untuk membuktikannya saya pun langsung mencoba untuk meng-input *test* pada form tersebut dan setelah saya enter, saya menemukan parameter yang cukup unik pada address bar ``` https://www.pointblank.id/faq/list?keyword=test ``` <br>
![ss_parameter](https://robotmikhael.github.io/img/IMG_20190415_105035.jpg) <br><br>
â€¢ Setelah itu saya coba *view-source* halaman tersebut , dan ini yang saya temukan : <br>
![ss_view-source_test_search](https://robotmikhael.github.io/img/IMG_20190415_105715.jpg) <br><br> 
Saya menyimpulkan bahwa kata *test* pada parameter ```?keyword= ``` ternyata ter-refleksi kedalam **[attribute html](https://www.google.com/search?q=attribute%20html)** yaitu pada bagian *value* ```value=test ```. Lalu saya coba masukkan ``` test"> ``` . <br>â€¢ Dan saya coba *view-source* kembali.<br>
![ss_view-source-2](https://robotmikhael.github.io/img/IMG_20190415_151229.jpg) <br><br>
Dari gambar di atas dapat kita lihat bahwa tidak adanya *filtering* pada karakter-kadakter seperti *double quote* ``` " ``` & karakter *greater-than* ``` > ```. "Kalau begitu bagaimana jika saya melakukan manipulasi pada **[attribute html](https://www.google.com/search?q=attribute%20html)** dan **[tag html](https://www.google.com/search?q=tag%20html)** untuk memunculkan *pop up javacript* (XSS)", pikir saya.<br>â€¢ Maka dari itu langsung saja saya coba masukkan payload ``` test"><body onload="javascript:alert(2)"><input value=" ``` setelah itu saya *view-source* : <br>
![ss_view-source-3](https://robotmikhael.github.io/img/IMG_20190415_160518.jpg) <br><br>
Dari gambar di atas dapat kita lihat bahwa saya berhasil melakukan manipulasi pada html tersebut. Berikut penjelasannya payloadnya : <br>
â€¢ **test">** : karakter ``` "> ``` digunakan untuk melepaskan diri dari attribute *value* yang berisi inputan user dan tag *input* . <br>
â€¢ ``` <body onload="javascript:prompt(d
ocument.domain)"> ``` : adalah script yang digunakan untuk memunculkan *pop up javascript* (XSS) . <br>
â€¢ ``` <input value=" ```  : digunakan untuk membuat **tag** dan **attribute** baru pada html agar tidak terjadi error . <br>
Lalu saya coba untuk meng-eksekusi payload tersebut di browser , namun ternyata kena block sama [XSS Auditor](https://www.google.com/search?q=xss%20auditor) <br>
![ss_eksekusi_payload-xss](https://robotmikhael.github.io/img/IMG_20190415_172128.jpg) <br><br>
Saya udah coba semua browser Android dan ternyata masih kena block sama XSS Auditor . Akhirnya saya meminta tolong pada teman yang memiliki pc untuk membantu saya mengecek apakah payload saya ter-eksekusi dengan baik dan memunculkan pop up javascript. Saya menyuruhnya untuk meng-eksekusi lewat browser *Mozilla*  , kalau berhasil saya memintanya untuk meng-screenshot/meng-foto itu. Ternyata berhasil , berikut fotonya : 




.


